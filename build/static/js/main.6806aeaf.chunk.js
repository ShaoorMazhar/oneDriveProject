(this["webpackJsonpmsal-react-quickstart"]=this["webpackJsonpmsal-react-quickstart"]||[]).push([[0],{109:function(e,t,n){},117:function(e,t,n){},149:function(e,t){},150:function(e,t){},151:function(e,t){},152:function(e,t){},153:function(e,t){},172:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),i=n(41),a=n.n(i),o=(n(108),n(109),n(35)),s=n(15),l=n(23),u=n(18),d=n(179),j="https://graph.microsoft.com/v1.0/me/drive/";var b=function(){return{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}},p=function(){var e=Object(l.a)(Object(s.a)().mark((function e(){return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.a.get(j+"root/children?$select=id,name,folder,file",b());case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=Object(l.a)(Object(s.a)().mark((function e(t){return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.a.get(j+"items/".concat(t),b());case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),f=n(39),O=n(67),m={auth:{clientId:"7524d99d-11b5-4428-8723-6573293daa88",authority:"https://login.microsoftonline.com/common",redirectUri:"http://localhost:3000/"},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!1},system:{loggerOptions:{loggerCallback:function(e,t,n){if(!n)switch(e){case O.a.Error:return void console.error(t);case O.a.Info:return void console.info(t);case O.a.Verbose:return void console.debug(t);case O.a.Warning:return void console.warn(t)}}}}},x={scopes:["User.Read"]},v="https://graph.microsoft.com/v1.0/me",g=n(103),y=n(68),w=n(48),k=n(7),S=function(){var e=Object(f.e)().instance,t=function(t){"popup"===t?e.loginPopup(x).catch((function(e){console.log(e)})):"redirect"===t&&e.loginRedirect(x).catch((function(e){console.log(e)}))};return Object(k.jsxs)(y.a,{variant:"secondary",className:"ml-auto",drop:"left",title:"Sign In",children:[Object(k.jsx)(w.a.Item,{as:"button",onClick:function(){return t("popup")},children:"Sign in using Popup"}),Object(k.jsx)(w.a.Item,{as:"button",onClick:function(){return t("redirect")},children:"Sign in using Redirect"})]})},N=function(){var e=Object(f.e)().instance,t=function(t){"popup"===t?e.logoutPopup({postLogoutRedirectUri:"/",mainWindowRedirectUri:"/"}):"redirect"===t&&e.logoutRedirect({postLogoutRedirectUri:"/"})};return Object(k.jsxs)(y.a,{variant:"secondary",className:"ml-auto",drop:"left",title:"Sign Out",children:[Object(k.jsx)(w.a.Item,{as:"button",onClick:function(){return t("popup")},children:"Sign out using Popup"}),Object(k.jsx)(w.a.Item,{as:"button",onClick:function(){return t("redirect")},children:"Sign out using Redirect"})]})},I=function(e){var t=Object(f.d)();return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsxs)(g.a,{bg:"primary",variant:"dark",children:[Object(k.jsx)("a",{className:"navbar-brand",href:"/",children:"Microsoft Identity Platform"}),t?Object(k.jsx)(N,{}):Object(k.jsx)(S,{})]}),Object(k.jsx)("h5",{children:Object(k.jsx)("center",{children:"Welcome to the Microsoft Authentication Library For Javascript - React Quickstart"})}),Object(k.jsx)("br",{}),Object(k.jsx)("br",{}),e.children]})},C=function(e){return console.log(e.graphData),Object(k.jsxs)("div",{id:"profile-div",children:[Object(k.jsxs)("p",{children:[Object(k.jsx)("strong",{children:"First Name: "})," ",e.graphData.givenName]}),Object(k.jsxs)("p",{children:[Object(k.jsx)("strong",{children:"Last Name: "})," ",e.graphData.surname]}),Object(k.jsxs)("p",{children:[Object(k.jsx)("strong",{children:"Email: "})," ",e.graphData.userPrincipalName]}),Object(k.jsxs)("p",{children:[Object(k.jsx)("strong",{children:"Id: "})," ",e.graphData.id]})]})};function T(){return(T=Object(l.a)(Object(s.a)().mark((function e(t){var n,c,r;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Headers,c="Bearer ".concat(t),n.append("Authorization",c),r={method:"GET",headers:n},e.abrupt("return",fetch(v,r).then((function(e){return e.json()})).catch((function(e){return console.log(e)})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var R=n(47);function D(e){var t=e.videoid;return Object(k.jsxs)("div",{children:[Object(k.jsx)("h4",{style:{marginTop:"3rem"},children:"Load the following files"}),Object(k.jsx)("div",{style:{marginTop:"1rem"},children:Object(k.jsx)(R.b,{to:"/imageCard",style:{fontSize:"18px"},children:"Image"})}),Object(k.jsx)("div",{style:{marginTop:"1rem"},children:Object(k.jsx)(R.b,{to:"/pdfCard",style:{fontSize:"18px"},children:"Pdf"})}),Object(k.jsx)("div",{style:{marginTop:"1rem"},children:Object(k.jsx)(R.b,{to:"/videoCard/".concat(t),style:{fontSize:"18px"},children:"Video"})})]})}n(117);var P=function(){var e,t=Object(c.useState)(""),n=Object(u.a)(t,2),r=n[0],i=n[1],a=function(){var e=Object(l.a)(Object(s.a)().mark((function e(){var t,n,c,r;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p();case 2:c=e.sent,r=null===c||void 0===c||null===(t=c.data)||void 0===t||null===(n=t.value)||void 0===n?void 0:n.map((function(e){var t;return"video/mp4"===(null===e||void 0===e||null===(t=e.file)||void 0===t?void 0:t.mimeType)?null===e||void 0===e?void 0:e.id:0})),i(r[2]);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){j.acquireTokenSilent(Object(o.a)(Object(o.a)({},x),{},{account:b[0]})).then((function(e){localStorage.setItem("token",e.accessToken),function(e){return T.apply(this,arguments)}(e.accessToken).then((function(e){v(e)}))})),a()}),[]);var d=Object(f.e)(),j=d.instance,b=d.accounts,h=Object(c.useState)(null),O=Object(u.a)(h,2),m=O[0],v=O[1];return console.log(b,"accounts"),Object(k.jsxs)(k.Fragment,{children:[Object(k.jsxs)("h5",{className:"card-title",children:["Welcome ",null===(e=b[0])||void 0===e?void 0:e.name]}),m?Object(k.jsx)(C,{graphData:m}):"",Object(k.jsx)(D,{videoid:r})]})},E=function(){return Object(k.jsxs)("div",{className:"App",children:[Object(k.jsx)(f.a,{children:Object(k.jsx)(P,{})}),Object(k.jsx)(f.c,{children:Object(k.jsx)("h5",{className:"card-title",children:"Please sign-in to see your profile information."})})]})};function F(){return Object(k.jsx)(I,{children:Object(k.jsx)(E,{})})}var L=n(178),U=n(13);function W(){var e=Object(U.l)();return Object(k.jsxs)("div",{className:"container text-center",children:[Object(k.jsx)("h3",{style:{marginTop:"2rem"},children:"This is Image"}),Object(k.jsxs)("div",{className:"row align-items-center mt-5",style:{display:"flex",flexDirection:"column"},children:[Object(k.jsx)("div",{style:{height:"500px",overflow:"hidden",padding:"0"},className:"col-5",children:Object(k.jsx)("img",{style:{objectFit:"contain"},src:"https://mymodernmet.com/wp/wp-content/uploads/2021/04/Nature-Sounds-For-Well-Being-03.jpg",alt:"dummyImage"})}),Object(k.jsx)("button",{type:"button",class:"btn btn-primary",style:{marginTop:"2rem"},onClick:function(){e("/")},children:"Back"})]})]})}var z=n.p+"static/media/myDoc.321aebea.pdf",A=n(62);function B(){Object(c.useEffect)((function(){A.c.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/".concat(A.c.version,"/pdf.worker.js")}));var e=Object(c.useState)(1),t=Object(u.a)(e,2),n=t[0],r=t[1],i=Object(c.useState)(1),a=Object(u.a)(i,2),o=a[0],s=a[1];function l(){r(n),s(1)}return console.log(z),Object(k.jsx)("div",{className:"container text-center",children:Object(k.jsx)("div",{className:"row justify-content-center mt-2",children:Object(k.jsx)("div",{style:{height:"96vh",overflow:"hidden",padding:"0",display:"flex",justifyContent:"center"},className:"col-8",children:Object(k.jsx)(A.a,{file:z,onloadSuccess:function(){return l},children:Object(k.jsx)(A.b,{pageNumber:o})})})})})}var q=n(102),J=n.n(q);var M=function(){var e=Object(c.useState)(""),t=Object(u.a)(e,2),n=t[0],r=t[1],i=Object(U.n)().id,a=function(){var e=Object(l.a)(Object(s.a)().mark((function e(){var t;return Object(s.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(i);case 2:t=e.sent,r(null===t||void 0===t?void 0:t.data["@microsoft.graph.downloadUrl"]);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){a()}),[]),Object(k.jsxs)("div",{className:"container text-center",children:[Object(k.jsx)("h3",{style:{marginTop:"2rem"},children:"This is Video"}),Object(k.jsx)("div",{className:"row justify-content-center mt-5",children:Object(k.jsx)("div",{style:{height:"500px",overflow:"hidden",padding:"0"},class:"col-9",children:Object(k.jsx)(J.a,{url:n,playing:!0,controls:!0,width:"100%",height:"500px"})})})]})},V=new L.a(m);a.a.render(Object(k.jsx)(R.a,{children:Object(k.jsx)(r.a.StrictMode,{children:Object(k.jsx)(f.b,{instance:V,children:Object(k.jsxs)(U.c,{children:[Object(k.jsx)(U.a,{path:"/",element:Object(k.jsx)(F,{})}),Object(k.jsx)(U.a,{path:"/imageCard",element:Object(k.jsx)(W,{})}),Object(k.jsx)(U.a,{path:"/pdfCard",element:Object(k.jsx)(B,{})}),Object(k.jsx)(U.a,{path:"/videoCard/:id",element:Object(k.jsx)(M,{})})]})})})}),document.getElementById("root"))},96:function(e,t){}},[[172,1,2]]]);
//# sourceMappingURL=main.6806aeaf.chunk.js.map